_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[11],{"1OyB":function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return a}))},"G8/X":function(e,t,n){e.exports={submitBtn:"dialog_submitBtn__1-orx",messageCard:"dialog_messageCard__YsuwO",bgLightBlue:"dialog_bgLightBlue__2ylYR",messageScroll:"dialog_messageScroll__3SiRX"}},JX7q:function(e,t,n){"use strict";function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return a}))},Ji7U:function(e,t,n){"use strict";function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}n.d(t,"a",(function(){return r}))},RD51:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dialog-system",function(){return n("h4p0")}])},cWnB:function(e,t,n){"use strict";var a=n("wx14"),r=n("zLVn"),o=n("TSYQ"),i=n.n(o),c=n("q1tI"),s=n.n(c),l=n("vUet"),u=n("dbZe"),f=s.a.forwardRef((function(e,t){var n=e.bsPrefix,o=e.variant,c=e.size,f=e.active,d=e.className,p=e.block,b=e.type,h=e.as,m=Object(r.a)(e,["bsPrefix","variant","size","active","className","block","type","as"]),g=Object(l.a)(n,"btn"),v=i()(d,g,f&&"active",g+"-"+o,p&&g+"-block",c&&g+"-"+c);if(m.href)return s.a.createElement(u.a,Object(a.a)({},m,{as:h,ref:t,className:i()(v,m.disabled&&"disabled")}));t&&(m.ref=t),b?m.type=b:h||(m.type="button");var y=h||"button";return s.a.createElement(y,Object(a.a)({},m,{className:v}))}));f.displayName="Button",f.defaultProps={variant:"primary",active:!1,disabled:!1},t.a=f},foSv:function(e,t,n){"use strict";function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return a}))},h4p0:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return K}));var a=n("q1tI"),r=n.n(a),o=n("8Kt/"),i=n.n(o),c=n("5M6V"),s=n("7vrA"),l=n("3Z9Z"),u=n("JI6e");function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function d(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var p=n("1OyB"),b=n("vuIU"),h=n("JX7q"),m=n("Ji7U"),g=n("md7G"),v=n("foSv");function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=n("G8/X"),j=n.n(O),S=n("wx14"),_=n("zLVn"),w=n("TSYQ"),N=n.n(w),C=n("vUet"),x=n("YdCC"),P=function(e){return r.a.forwardRef((function(t,n){return r.a.createElement("div",Object(S.a)({},t,{ref:n,className:N()(t.className,e)}))}))},R=n("Wzyw"),E=r.a.forwardRef((function(e,t){var n=e.bsPrefix,a=e.className,o=e.variant,i=e.as,c=void 0===i?"img":i,s=Object(_.a)(e,["bsPrefix","className","variant","as"]),l=Object(C.a)(n,"card-img");return r.a.createElement(c,Object(S.a)({ref:t,className:N()(o?l+"-"+o:l,a)},s))}));E.displayName="CardImg",E.defaultProps={variant:null};var D=E,T=P("h5"),B=P("h6"),k=Object(x.a)("card-body"),U=Object(x.a)("card-title",{Component:T}),M=Object(x.a)("card-subtitle",{Component:B}),A=Object(x.a)("card-link",{Component:"a"}),I=Object(x.a)("card-text",{Component:"p"}),J=Object(x.a)("card-header"),L=Object(x.a)("card-footer"),X=Object(x.a)("card-img-overlay"),V=r.a.forwardRef((function(e,t){var n=e.bsPrefix,o=e.className,i=e.bg,c=e.text,s=e.border,l=e.body,u=e.children,f=e.as,d=void 0===f?"div":f,p=Object(_.a)(e,["bsPrefix","className","bg","text","border","body","children","as"]),b=Object(C.a)(n,"card"),h=Object(a.useMemo)((function(){return{cardHeaderBsPrefix:b+"-header"}}),[b]);return r.a.createElement(R.a.Provider,{value:h},r.a.createElement(d,Object(S.a)({ref:t},p,{className:N()(o,b,i&&"bg-"+i,c&&"text-"+c,s&&"border-"+s)}),l?r.a.createElement(k,null,u):u))}));V.displayName="Card",V.defaultProps={body:!1},V.Img=D,V.Title=U,V.Subtitle=M,V.Body=k,V.Link=A,V.Text=I,V.Header=J,V.Footer=L,V.ImgOverlay=X;var F=V,q=n("cWnB"),z=r.a.createElement;function Y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(v.a)(e);if(t){var r=Object(v.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(g.a)(this,n)}}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e){var t="".concat("http://0.0.0.0:5000","/api/v1"),n=e.output,a=e.isMe,r=a?n:n.text_template,o=z(F.Body,{className:"p-2"},r);return!a&&"generic"in n&&n.generic.forEach((function(n){if("option"===n.response_type){n.preference;var a=z("b",null,n.title),r=z("span",null,n.description),i=n.options.map((function(n,a){return z("li",{style:{cursor:"pointer"}},z(F.Link,{key:a,onClick:function(){return function(n){var a=new URL("".concat(t,"/message"));e.handleDialogChange({isMe:!0,output:n.label});var r=W(W({},n.value),{},{dialog_state:e.dialogState});fetch(a,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors"}).then((function(e){if(200===e.status)return e.json()})).then(e.handleResponse).catch((function(t){e.handleDialogChange({isMe:!1,output:"Server not available"}),console.error("Error:",t)}))}(n)}},n.label))}));o=z(F.Body,{className:"p-2"},a," ",z("br",null),r,z("ul",null,i))}})),z("div",{className:"row ".concat(a?"justify-content-end":"")},z("div",{className:"card ".concat(j.a.messageCard," ").concat(a?j.a.bgLightBlue:""," m-1")},o))}var H=function(e){Object(m.a)(n,e);var t=Y(n);function n(e){var a;return Object(p.a)(this,n),a=t.call(this,e),y(Object(h.a)(a),"scrollToBottom",(function(){a.messagesEnd.scrollIntoView({behavior:"smooth"})})),a.scrollToBottom=a.scrollToBottom.bind(Object(h.a)(a)),a}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props.messages.map((function(t,n){return z(Z,{output:t.output,isMe:t.isMe,handleDialogChange:e.props.handleDialogChange,handleResponse:e.props.handleResponse,dialogState:e.props.dialogState,key:n})}));return z("div",{className:"container-fluid ".concat(j.a.messageScroll)},t,z("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}}))}}]),n}(a.Component),Q=function(e){Object(m.a)(n,e);var t=Y(n);function n(e){var a;Object(p.a)(this,n),(a=t.call(this,e)).chatBoxTitle=e.chatBoxTitle||"My Virtual Asisstant",a.serverNotAvailableMsg="Incerc sa stabilesc conexiunea cu serverul de dialog, incearca te rog peste cateva momente",a.stopDialogVariable="$leg_op",a.startUtt="...";return a.apiUrl="".concat("http://0.0.0.0:5000","/api/v1"),a.handleUtteranceChange=a.handleUtteranceChange.bind(Object(h.a)(a)),a.handleSubmitForm=a.handleSubmitForm.bind(Object(h.a)(a)),a.handleResponse=a.handleResponse.bind(Object(h.a)(a)),a.handleDialogChange=a.handleDialogChange.bind(Object(h.a)(a)),a.state={stopDialog:!1,dialog:[],apiResponse:{},utterance:""},a}return Object(b.a)(n,[{key:"handleResponse",value:function(e){var t=this;e&&this.setState((function(n){var a,r=d(n.dialog),o=[];return e.outputs.forEach((function(e){o.push({isMe:!1,output:e})})),(a=e.dialog_state.context_variables[t.stopDialogVariable])&&o.length>0?r.push(o[0]):r=r.concat(o),{apiResponse:e,dialog:r,stopDialog:a}}))}},{key:"componentDidMount",value:function(){var e=this,t=new URL(this.apiUrl+"/message"),n={input:{text:this.state.utterance}};fetch(t,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors"}).then((function(e){if(200===e.status)return e.json()})).then(this.handleResponse).catch((function(t){e.setState((function(t){var n=d(t.dialog);return n.push({isMe:!1,output:{text_template:e.serverNotAvailableMsg}}),{dialog:n}})),console.error("Error:",t)}))}},{key:"handleUtteranceChange",value:function(e){e.preventDefault();var t=e.target.value;"\n"===t.charAt(t.length-1)?this.handleSubmitForm(e):this.setState({utterance:e.target.value})}},{key:"handleDialogChange",value:function(e){this.setState((function(t){var n=d(t.dialog);return n.push(e),{dialog:n}}))}},{key:"handleSubmitForm",value:function(e){var t=this;e.preventDefault();var n=new URL("".concat(this.apiUrl,"/message"));this.setState((function(e){var n=d(e.dialog);return n.push({isMe:!0,output:t.state.utterance}),{dialog:n}}));var a={input:{text:this.state.utterance},dialog_state:this.state.apiResponse.dialog_state};this.setState({utterance:""}),fetch(n,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors"}).then((function(e){if(200===e.status)return e.json()})).then(this.handleResponse).catch((function(e){t.setState((function(e){var n=d(e.dialog);return n.push({isMe:!1,output:{text_template:t.serverNotAvailableMsg}}),{dialog:n}})),console.error("Error:",e)}))}},{key:"render",value:function(){return z("div",null,z("div",{className:"card"},z("div",{className:"card-header"},z("h5",null,this.chatBoxTitle)),z("div",{className:"card-body d-flex flex-column p-1"},z(H,{messages:this.state.dialog,handleDialogChange:this.handleDialogChange,handleResponse:this.handleResponse,dialogState:this.state.apiResponse.dialog_state}),z("form",{onSubmit:this.handleSubmitForm,className:"mt-3 p-1"},z("div",{className:"input-group"},z("input",{type:"text",className:"form-control",id:"utterance",autoComplete:"off",value:this.state.utterance,onChange:this.handleUtteranceChange,placeholder:this.startUtt}),z(q.a,y({type:"submit",className:"float-right ".concat(j.a.submitBtn," ml-1"),color:"primary"},"type","submit"),"Send"))))))}}]),n}(a.Component),$=r.a.createElement;function K(){return $(c.a,{home:!0},$(i.a,null,$("title",null,"".concat(c.b," - dialog system"))),$(s.a,null,$(l.a,{className:"justify-content-center"},$(u.a,null,$(Q,{chatBoxTitle:"Test Assistant"})))))}},md7G:function(e,t,n){"use strict";function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return o}));var r=n("JX7q");function o(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?Object(r.a)(e):t}},vuIU:function(e,t,n){"use strict";function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",(function(){return r}))}},[["RD51",0,2,1,3]]]);